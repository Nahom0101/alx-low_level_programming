more functions and more nested loops for c
